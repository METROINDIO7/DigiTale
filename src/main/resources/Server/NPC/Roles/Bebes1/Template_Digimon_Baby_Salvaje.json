{
  "Type": "Abstract",
  "StartState": "Idle",
  "Parameters": {
    "Appearance":      { "Value": "Botamon_Model", "Description": "Modelo visual" },
    "MaxHealth":       { "Value": 30,              "Description": "Salud maxima" },
    "ViewRange":       { "Value": 12,              "Description": "Rango de vision" },
    "ViewSector":      { "Value": 180,             "Description": "Sector de vision en grados" },
    "HearingRange":    { "Value": 8,               "Description": "Rango de oido" },
    "AlertedRange":    { "Value": 16,              "Description": "Rango alerta" },
    "WanderRadius":    { "Value": 8,               "Description": "Radio de deambulacion" },
    "MaxSpeed":        { "Value": 4,               "Description": "Velocidad maxima" },
    "AttackWhenStartled": { "Value": true,         "Description": "Ataca si lo golpean de cerca" },
    "Attack":          { "Value": "Root_NPC_Attack_Melee", "Description": "Ataque al ser provocado" },
    "DropList":        { "Value": "Empty",         "Description": "Items al morir" },
    "AttitudeGroup":   { "Value": "Prey",          "Description": "Grupo de actitud" },
    "IsMemory":        { "Value": false,           "Description": "Si es un recuerdo" },
    "MemoriesCategory":     { "Value": "Other",    "Description": "Categoria del recuerdo" },
    "MemoriesNameOverride": { "Value": "",          "Description": "Nombre override" },
    "NameTranslationKey":   { "Value": "server.npcRoles.Template.name", "Description": "Clave de nombre" }
  },
  "IsMemory":              { "Compute": "IsMemory" },
  "MemoriesCategory":      { "Compute": "MemoriesCategory" },
  "MemoriesNameOverride":  { "Compute": "MemoriesNameOverride" },
  "DropList":              { "Compute": "DropList" },
  "Appearance":            { "Compute": "Appearance" },
  "DefaultPlayerAttitude": "Neutral",
  "DefaultNPCAttitude":    "Ignore",
  "AttitudeGroup":         { "Compute": "AttitudeGroup" },
  "DisableDamageGroups":   ["Self"],
  "KnockbackScale": 1.0,
  "MotionControllerList": [{
    "Type": "Walk",
    "MaxWalkSpeed": { "Compute": "MaxSpeed" },
    "Gravity": 10, "MaxFallSpeed": 8, "Acceleration": 10, "MaxRotationSpeed": 360
  }],
  "MaxHealth": { "Compute": "MaxHealth" },
  "InteractionVars": {
    "Melee_Damage": {
      "Interactions": [{
        "Parent": "NPC_Attack_Melee_Damage",
        "DamageCalculator": {
          "Type": "Absolute",
          "BaseDamage": { "Physical": 3 },
          "RandomPercentageModifier": 0.1
        }
      }]
    }
  },
  "StateTransitions": [
    {
      "States": [{ "To": ["Idle"], "From": [] }],
      "Actions": [
        { "Type": "ReleaseTarget" },
        { "Type": "ResetInstructions" },
        { "Type": "PlayAnimation", "Slot": "Status" }
      ]
    },
    {
      "States": [{ "To": [], "From": ["Alerted", "Flee"] }],
      "Actions": [{ "Type": "PlayAnimation", "Slot": "Status" }]
    }
  ],
  "Instructions": [{
    "Instructions": [
      {
        "Sensor": { "Type": "State", "State": "Idle" },
        "Instructions": [
          {
            "Reference": "Component_Instruction_Damage_Check",
            "Modify": {
              "_ExportStates": ["Flee.Switch", "Panic"],
              "AlertedRange": { "Compute": "AlertedRange" }
            }
          },
          {
            "Sensor": {
              "Reference": "Component_Sensor_Standard_Detection",
              "Modify": {
                "ViewRange":              { "Compute": "ViewRange" },
                "ViewSector":             { "Compute": "ViewSector" },
                "HearingRange":           { "Compute": "HearingRange" },
                "AbsoluteDetectionRange": 0,
                "Attitudes": ["Hostile", "Neutral"]
              }
            },
            "Actions": [{ "Type": "State", "State": "Alerted" }]
          },
          {
            "BodyMotion": {
              "Type": "Sequence", "Looped": true,
              "Motions": [
                { "Type": "Timer", "Time": [2, 5],
                  "Motion": { "Type": "WanderInCircle",
                    "Radius": { "Compute": "WanderRadius" },
                    "MaxHeadingChange": 60, "RelativeSpeed": 0.2 } },
                { "Type": "Timer", "Time": [3, 6],
                  "Motion": { "Type": "Nothing" } }
              ]
            }
          }
        ]
      },
      {
        "Sensor": { "Type": "State", "State": "Alerted" },
        "Instructions": [
          {
            "Continue": true,
            "Sensor": { "Type": "Any", "Once": true },
            "Actions": [{ "Type": "PlayAnimation", "Slot": "Status", "Animation": "Alerted" }]
          },
          {
            "Reference": "Component_Instruction_Damage_Check",
            "Modify": {
              "_ExportStates": ["Flee.Switch", "Panic"],
              "AlertedRange": { "Compute": "AlertedRange" }
            }
          },
          {
            "Continue": true,
            "Sensor": { "Type": "Target", "Range": { "Compute": "AlertedRange" } },
            "HeadMotion": { "Type": "Watch" }
          },
          {
            "Sensor": {
              "Type": "Target",
              "Range": { "Compute": "ViewRange" },
              "Filters": [{ "Type": "LineOfSight" }]
            },
            "Actions": [{
              "Type": "Timeout", "Delay": [1.5, 2.5],
              "Action": { "Type": "State", "State": "Flee" }
            }]
          },
          {
            "Sensor": { "Type": "Not", "Sensor": { "Type": "Target", "Range": { "Compute": "AlertedRange" } } },
            "Actions": [{ "Type": "State", "State": "Idle" }]
          }
        ]
      },
      {
        "Sensor": { "Type": "State", "State": "Flee" },
        "Instructions": [
          {
            "Reference": "Component_Instruction_Damage_Check",
            "Modify": {
              "_ExportStates": ["Flee.Switch", "Panic"],
              "AlertedRange": { "Compute": "AlertedRange" }
            }
          },
          {
            "Sensor": { "Type": "State", "State": ".Switch" },
            "Instructions": [
              {
                "Enabled": { "Compute": "AttackWhenStartled" },
                "Sensor": {
                  "Type": "Target",
                  "TargetSlot": "LockedTarget",
                  "Range": 2.5,
                  "Filters": [{ "Type": "Not", "Filter": { "Type": "ViewSector", "ViewSector": 270 } }]
                },
                "ActionsBlocking": true,
                "Actions": [
                  { "Type": "PlayAnimation", "Slot": "Status", "Animation": "Alerted" },
                  { "Type": "Timeout", "Delay": [0.2, 0.2] },
                  { "Type": "PlayAnimation", "Slot": "Status" },
                  { "Type": "OverrideAttitude", "Attitude": "Hostile", "Duration": 15 },
                  {
                    "Type": "Attack",
                    "Attack": { "Compute": "Attack" },
                    "AttackPauseRange": [1.5, 2.0]
                  },
                  { "Type": "State", "State": ".Default" }
                ]
              },
              {
                "Actions": [{ "Type": "State", "State": ".Default" }]
              }
            ]
          },
          {
            "Sensor": { "Type": "Target", "Range": { "Compute": "AlertedRange" } },
            "BodyMotion": {
              "Type": "Flee",
              "SlowDownDistance": { "Compute": "AlertedRange - 3" },
              "StopDistance":     { "Compute": "AlertedRange + 1" },
              "RelativeSpeed": 0.7
            },
            "Actions": [{
              "Type": "Timeout", "Delay": [8, 8],
              "Action": { "Type": "State", "State": ".Switch" }
            }]
          },
          {
            "Actions": [{ "Type": "State", "State": "Idle" }]
          }
        ]
      },
      {
        "Sensor": { "Type": "State", "State": "Panic" },
        "Instructions": [
          {
            "Continue": true,
            "Sensor": { "Type": "Any", "Once": true },
            "Actions": [{ "Type": "PlayAnimation", "Slot": "Status", "Animation": "Alerted" }]
          },
          {
            "Continue": true,
            "Actions": [{
              "Type": "Timeout", "Delay": [6, 10],
              "Action": { "Type": "State", "State": "Idle" }
            }]
          },
          {
            "Sensor": { "Type": "Damage", "Combat": true },
            "BodyMotion": { "Type": "Flee", "SlowDownDistance": 8, "StopDistance": 14, "RelativeSpeed": 1.0, "RelaxedMoveConstraints": false }
          },
          {
            "BodyMotion": { "Type": "WanderInCircle", "Radius": 10, "MaxHeadingChange": 90, "RelativeSpeed": 1.0, "RelaxedMoveConstraints": true }
          }
        ]
      }
    ]
  }],
  "NameTranslationKey": { "Compute": "NameTranslationKey" }
}
